# simforge.yaml — asset pipeline configuration
# Run: simforge process -c simforge.yaml
# Docs: https://github.com/ArconicLabs/simforge

pipeline:
  source: ./samples/
  output: ./sim_ready/

  # Export to one or more target formats.
  # Each asset is exported to every format listed here.
  # Supported: usd, usda, usdc, urdf, mjcf, gltf, glb, obj, stl, fbx
  target_formats: [usd, urdf, mjcf]

  # Parallel processing: 0 = auto (hardware_concurrency), 1 = sequential
  # threads: 0

  # Force reprocessing: ignore cached hashes, reprocess everything
  # force: false

stages:
  ingest:
    formats: [obj, fbx, gltf, glb, stl, step, iges, urdf, mjcf, dae]

  collision:
    method: convex_hull         # convex_hull | primitive | triangle_mesh | coacd (requires -DSIMFORGE_USE_COACD=ON)
    max_hulls: 32

    # CoACD settings (only used when method: coacd and -DSIMFORGE_USE_COACD=ON):
    # threshold: 0.05           # Concavity threshold (lower = more precise)
    # resolution: 2000

  physics:
    mass_estimation: geometry   # geometry | explicit | lookup
    density: 1000.0             # kg/m³ (water = 1000, plastic ≈ 950, steel ≈ 7800)
    friction: 0.5
    restitution: 0.3

    # Material library for lookup mode — maps material names to physics properties.
    # Use mass_estimation: lookup to enable. Materials are resolved from
    # asset.metadata["material"] or PBR material names, with geometry fallback.
    # material_library: data/materials.yaml

  optimize:
    lod_levels: [high, medium, low]
    max_triangles: [50000, 10000, 2000]

  validate:
    watertight: true
    physics_plausibility: true
    collision_correctness: true
    mesh_integrity: true
    scale_sanity: true
    fail_on_warning: false

  export:
    # Override target_formats per-stage, or omit to use pipeline-level setting.
    # Simple list:
    formats: [usd, urdf, mjcf]

    # Advanced: per-format output subdirectories
    # formats:
    #   - format: usd
    #     subdir: isaac/
    #   - format: urdf
    #     subdir: gazebo/
    #   - format: mjcf
    #     subdir: mujoco/

    catalog: true
